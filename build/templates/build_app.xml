<project name="Overseer" default="create-bundle" basedir=".">
    <!--
        This Ant build file builds a MacOS application from the
        JAR file. This will be built in the `release` directory.
        Note - this is based on the `main` method in the
        application structure.
    -->

    <property name="jar_filename" value="overseer.jar"/>

    <property name="app_name" value="Overseer"/>
    <property name="app_display_name" value="Overseer"/>
    <property name="short_version" value="version"/>

    <property name="icon_filename" value="icon.icns"/>
    <property name="copyright_holder" value="Andrew Bengier"/>
    <property name="app_identifier" value="bnfd.overseer"/>
    <property name="main_class_name" value="com.bnfd.overseer.OverseerApplication"/>

    <property name="app_category" value="public.app-category.utilities"/>

    <property environment="prod"/>
    <property name="release.dir" value="release"/>

    <!-- assumes appbundler-1.0.jar is in the current dir -->
    <taskdef name="bundleapp" classname="com.oracle.appbundler.AppBundlerTask" classpath="appbundler-1.0.jar"/>

    <target name="clean">
        <echo message="clean task ..."/>
        <delete dir="${release.dir}" quiet="true"/>
        <mkdir dir="${release.dir}"/>
        <delete dir="${release.dir}/${app_name}.app"/>
    </target>

    <target name="create-bundle" depends="clean">
        <bundleapp outputdirectory="${release.dir}"
                   name="${app_name}"
                   displayname="${app_display_name}"
                   identifier="${app_identifier}"
                   shortversion="${short_version}"
                   icon="${icon_filename}"
                   copyright="${copyright_holder}"
                   applicationCategory="${app_category}"
                   mainclassname="${main_class_name}">

            <runtime dir="runtime"/>

            <classpath file="${jar_filename}"/>

            <option value="-Xms64m"/>
            <option value="-Xmx256m"/>
            <option value="-XX:PermSize=20m"/>
            <option value="-XX:MaxPermSize=20m"/>

            <option value="-XX:+UseConcMarkSweepGC"/>
            <option value="-XX:ParallelCMSThreads=2"/>

            <option value="-Xdock:icon=Contents/Resources/${icon_filename}"/>
            <option value="-Dapple.laf.useScreenMenuBar=true"/>
            <option value="-Dcom.apple.macos.use-file-dialog-packages=true"/>
            <option value="-Dcom.apple.macos.useScreenMenuBar=true"/>
            <option value="-Dapple.awt.application.name=${app_display_name}"/>
            <option value="-Dcom.apple.smallTabs=true"/>
        </bundleapp>
    </target>
</project>
